{"version":3,"file":"primeng-chart.js","sources":["../../src/app/components/chart/chart.ts","../../src/app/components/chart/primeng-chart.ts"],"sourcesContent":["import {NgModule,Component,ElementRef,AfterViewInit,OnDestroy,Input,Output,EventEmitter,ChangeDetectionStrategy, ViewEncapsulation} from '@angular/core';\r\nimport {CommonModule} from '@angular/common';\r\nimport * as Chart from 'chart.js';\r\n\r\n@Component({\r\n    selector: 'p-chart',\r\n    template: `\r\n        <div style=\"position:relative\" [style.width]=\"responsive && !width ? null : width\" [style.height]=\"responsive && !height ? null : height\">\r\n            <canvas [attr.width]=\"responsive && !width ? null : width\" [attr.height]=\"responsive && !height ? null : height\" (click)=\"onCanvasClick($event)\"></canvas>\r\n        </div>\r\n    `,\r\n    changeDetection: ChangeDetectionStrategy.OnPush,\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class UIChart implements AfterViewInit, OnDestroy {\r\n\r\n    @Input() type: string;\r\n\r\n    @Input() plugins: any[] = [];\r\n    \r\n    @Input() width: string;\r\n    \r\n    @Input() height: string;\r\n\r\n    @Input() responsive: boolean = true;\r\n    \r\n    @Output() onDataSelect: EventEmitter<any> = new EventEmitter();\r\n\r\n    initialized: boolean;\r\n    \r\n    _data: any;\r\n\r\n    _options: any = {};\r\n\r\n    chart: any;\r\n\r\n    constructor(public el: ElementRef) {}\r\n    \r\n    @Input() get data(): any {\r\n        return this._data;\r\n    }\r\n\r\n    set data(val:any) {\r\n        this._data = val;\r\n        this.reinit();\r\n    }\r\n\r\n    @Input() get options(): any {\r\n        return this._options;\r\n    }\r\n\r\n    set options(val:any) {\r\n        this._options = val;\r\n        this.reinit();\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        this.initChart();\r\n        this.initialized = true;\r\n    }\r\n\r\n    onCanvasClick(event) {\r\n        if (this.chart) {\r\n            let element = this.chart.getElementAtEvent(event);\r\n            let dataset = this.chart.getDatasetAtEvent(event);\r\n            if (element && element[0] && dataset) {\r\n                this.onDataSelect.emit({originalEvent: event, element: element[0], dataset: dataset});\r\n            }\r\n        }\r\n    }\r\n\r\n    initChart() {\r\n        let opts = this.options||{};\r\n        opts.responsive = this.responsive;\r\n\r\n        // allows chart to resize in responsive mode\r\n        if (opts.responsive&&(this.height||this.width)) {\r\n            opts.maintainAspectRatio = false;\r\n        }\r\n\r\n        this.chart = new Chart(this.el.nativeElement.children[0].children[0], {\r\n            type: this.type,\r\n            data: this.data,\r\n            options: this.options,\r\n            plugins: this.plugins\r\n        });\r\n    }\r\n    \r\n    getCanvas() {\r\n        return this.el.nativeElement.children[0].children[0];\r\n    }\r\n    \r\n    getBase64Image() {\r\n        return this.chart.toBase64Image();\r\n    }\r\n    \r\n    generateLegend() {\r\n        if (this.chart) {\r\n            return this.chart.generateLegend();\r\n        }\r\n    }\r\n    \r\n    refresh() {\r\n        if (this.chart) {\r\n            this.chart.update();\r\n        }\r\n    }\r\n    \r\n    reinit() {\r\n        if (this.chart) {\r\n            this.chart.destroy();\r\n            this.initChart();\r\n        }\r\n    }\r\n    \r\n    ngOnDestroy() {\r\n        if (this.chart) {\r\n            this.chart.destroy();\r\n            this.initialized = false;\r\n            this.chart = null;\r\n        }\r\n    }\r\n}\r\n\r\n@NgModule({\r\n    imports: [CommonModule],\r\n    exports: [UIChart],\r\n    declarations: [UIChart]\r\n})\r\nexport class ChartModule { }\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":";;;;MAca,OAAO;IAsBhB,YAAmB,EAAc;QAAd,OAAE,GAAF,EAAE,CAAY;QAlBxB,YAAO,GAAU,EAAE,CAAC;QAMpB,eAAU,GAAY,IAAI,CAAC;QAE1B,iBAAY,GAAsB,IAAI,YAAY,EAAE,CAAC;QAM/D,aAAQ,GAAQ,EAAE,CAAC;KAIkB;IAErC,IAAa,IAAI;QACb,OAAO,IAAI,CAAC,KAAK,CAAC;KACrB;IAED,IAAI,IAAI,CAAC,GAAO;QACZ,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC;QACjB,IAAI,CAAC,MAAM,EAAE,CAAC;KACjB;IAED,IAAa,OAAO;QAChB,OAAO,IAAI,CAAC,QAAQ,CAAC;KACxB;IAED,IAAI,OAAO,CAAC,GAAO;QACf,IAAI,CAAC,QAAQ,GAAG,GAAG,CAAC;QACpB,IAAI,CAAC,MAAM,EAAE,CAAC;KACjB;IAED,eAAe;QACX,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;KAC3B;IAED,aAAa,CAAC,KAAK;QACf,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,IAAI,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;YAClD,IAAI,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;YAClD,IAAI,OAAO,IAAI,OAAO,CAAC,CAAC,CAAC,IAAI,OAAO,EAAE;gBAClC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAC,aAAa,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAC,CAAC,CAAC;aACzF;SACJ;KACJ;IAED,SAAS;QACL,IAAI,IAAI,GAAG,IAAI,CAAC,OAAO,IAAE,EAAE,CAAC;QAC5B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;;QAGlC,IAAI,IAAI,CAAC,UAAU,KAAG,IAAI,CAAC,MAAM,IAAE,IAAI,CAAC,KAAK,CAAC,EAAE;YAC5C,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;SACpC;QAED,IAAI,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,EAAE;YAClE,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,IAAI,EAAE,IAAI,CAAC,IAAI;YACf,OAAO,EAAE,IAAI,CAAC,OAAO;YACrB,OAAO,EAAE,IAAI,CAAC,OAAO;SACxB,CAAC,CAAC;KACN;IAED,SAAS;QACL,OAAO,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;KACxD;IAED,cAAc;QACV,OAAO,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC;KACrC;IAED,cAAc;QACV,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,OAAO,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;SACtC;KACJ;IAED,OAAO;QACH,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC;SACvB;KACJ;IAED,MAAM;QACF,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;YACrB,IAAI,CAAC,SAAS,EAAE,CAAC;SACpB;KACJ;IAED,WAAW;QACP,IAAI,IAAI,CAAC,KAAK,EAAE;YACZ,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,CAAC;YACrB,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YACzB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;SACrB;KACJ;;;YArHJ,SAAS,SAAC;gBACP,QAAQ,EAAE,SAAS;gBACnB,QAAQ,EAAE;;;;KAIT;gBACD,eAAe,EAAE,uBAAuB,CAAC,MAAM;gBAC/C,aAAa,EAAE,iBAAiB,CAAC,IAAI;aACxC;;;YAb0B,UAAU;;;mBAgBhC,KAAK;sBAEL,KAAK;oBAEL,KAAK;qBAEL,KAAK;yBAEL,KAAK;2BAEL,MAAM;mBAYN,KAAK;sBASL,KAAK;;MAkFG,WAAW;;;YALvB,QAAQ,SAAC;gBACN,OAAO,EAAE,CAAC,YAAY,CAAC;gBACvB,OAAO,EAAE,CAAC,OAAO,CAAC;gBAClB,YAAY,EAAE,CAAC,OAAO,CAAC;aAC1B;;;AChID;;;;;;"}